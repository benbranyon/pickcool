<div ng-controller="ContestViewCtrl" class="view">
  <div ng-if="contest" class="contest">
    <h1>
      {{contest.title}}
      <button ng-if="contest.is_editable" class="btn btn-xs btn-success" ui-sref="contests-edit({contest_id: contest.id})">Edit</button>
    </h1>
    <p>
      <b><i>Click your favorite image below to cast your vote.</i></b>
    </p>
    
    <div class="candidate" ng-repeat="candidate in contest.candidates">
      <h2>{{candidate.name}} </h2>
      <h3>{{candidate.vote_count}} votes</h3>
      <a class="thumb" ng-href="{{contest.canonical_url}}" ng-click="vote(candidate)" ng-class="{selected: contest.current_user_candidate_id == candidate.id}">
        <img ng-src="{{candidate.image('mobile')}}"/>
      </a>
      <button class="btn btn-warning even" ng-click="unvote(candidate)" ng-if="contest.current_user_candidate_id == candidate.id ">Unvote</button>
      <button class="btn btn-success even" ng-click="vote(candidate)" ng-if="contest.current_user_candidate_id != candidate.id ">Vote</button>
      <button class="btn btn-primary even" ng-click="share(candidate)"><i class="fa fa-facebook"></i> Share</button>
    </div>
    <div class="clearfix"></div>
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Discussion</h3>
          </div>
          <div class="panel-body" style="padding-left: 0px; padding-right: 0px;padding-top:0px" ng-if="fb_loaded">
            <div class="fb-comments" data-href="{{contest.canonical_url}}" data-numposts="5" data-colorscheme="light" data-width="100%"></div>
          </div>
        </div>          
      </div>
    </div>
  </div>
</div>
